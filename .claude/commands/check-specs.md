# /check-specs コマンド

指定されたファイルまたは機能に関連する確定仕様を確認してください。

## 確認する場所（優先順位）

1. **`docs/specs/index.md`** - SPEC一覧（単一情報源）
2. **`docs/specs/SPEC-*.md`** - 各SPEC詳細
3. **`CLAUDE.md`** の「確定仕様（変更禁止）」セクション（参照用サマリー）
4. **`docs/troubleshooting.md`** の確定仕様マーク付きセクション（参照用）
5. 対象ファイルのディレクトリにある `CLAUDE.md`（存在する場合）

## 必須出力形式

```markdown
## 確定仕様チェック結果

### 対象
- ファイル/機能: `{入力された対象}`

### 関連SPEC

| SPEC ID | タイトル | ステータス |
|---------|----------|-----------|
| SPEC-XXX-NNN | タイトル | ✅ confirmed |

### 禁止事項（forbidden_changes）

以下の変更は禁止されています：

- ❌ [禁止事項1]
- ❌ [禁止事項2]

### 変更時の確認

この仕様に関連する変更を行う場合：

1. ユーザーに変更意図を確認してください
2. 変更理由を明示的に記録してください
3. `/record` でドキュメントを更新してください
4. ガードテスト（`tests/specs/SPEC-XXX-NNN.test.ts`）が通ることを確認してください
```

## 引数

| 引数 | 説明 | 例 |
|------|------|-----|
| ファイルパス | そのファイルに関連する確定仕様を表示 | `/check-specs src/app/stp/agents/agents-table.tsx` |
| 機能名 | その機能に関連する確定仕様を表示 | `/check-specs 顧問表示` |
| なし | 全ての確定仕様を一覧表示 | `/check-specs` |

## 検索ロジック

### ファイルパスが指定された場合

1. `docs/specs/index.md` を読み込む
2. 各SPECの `関連ファイル` にファイルパスが含まれるか確認
3. 該当するSPECを全て表示

### 機能名が指定された場合

1. `docs/specs/` 内の全SPECを検索
2. タイトル・概要・本文にキーワードが含まれるSPECを表示

### 引数なしの場合

1. `docs/specs/index.md` の一覧を全て表示
2. 各SPECの概要を1行で表示

## 出力例

### `/check-specs src/app/stp/agents/agents-table.tsx`

```markdown
## 確定仕様チェック結果

### 対象
- ファイル: `src/app/stp/agents/agents-table.tsx`

### 関連SPEC

| SPEC ID | タイトル | ステータス |
|---------|----------|-----------|
| [SPEC-STP-001](docs/specs/SPEC-STP-001.md) | 顧問の区分表示形式 | ✅ confirmed |

### 禁止事項（forbidden_changes）

以下の変更は禁止されています：

- ❌ 未入力時に括弧を省略する（例: `顧問` → 禁止）
- ❌ スラッシュ区切りをスペース区切りに変更する
- ❌ 片方のみ入力時に `-` を省略する

### 変更時の確認

この仕様に関連する変更を行う場合：

1. ユーザーに変更意図を確認してください
2. 変更理由を明示的に記録してください
3. `/record` でドキュメントを更新してください
4. ガードテスト（`tests/specs/SPEC-STP-001.test.ts`）が通ることを確認してください
```

## 注意事項

- **単一情報源**: `docs/specs/` が正（Source of Truth）。他の場所は参照用
- **ステータス確認**: `✅ confirmed` は変更禁止、`🔄 draft` は変更可能
- **テスト確認**: 関連するガードテストがある場合は必ず実行

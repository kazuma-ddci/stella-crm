# P1: CrudTable編集機能の修正

## 問題
「編集ができません」という報告

## 原因
1. **SelectItemの空文字列問題**: shadcn/uiのSelectコンポーネントで空文字列`""`をvalueに使用すると正常に動作しない
2. **型変換の問題**: フォームから送信される値は文字列だが、サーバーアクション側で数値として期待していた

## 修正内容

### 1. crud-table.tsx
SelectItemの空値を`"__empty__"`に変更:
```typescript
// 修正前
<SelectItem value="">-</SelectItem>
value={String(value ?? "")}

// 修正後
<SelectItem value="__empty__">-</SelectItem>
value={value != null ? String(value) : "__empty__"}
```

### 2. 各actionsファイルの型変換修正

以下のファイルで、フォームから来る文字列を適切に数値やnullに変換:

- `src/app/stp/companies/actions.ts`
- `src/app/stp/agents/actions.ts`
- `src/app/stp/settings/stages/actions.ts`
- `src/app/stp/settings/contact-methods/actions.ts`
- `src/app/stp/records/company-contacts/actions.ts`
- `src/app/stp/records/agent-contacts/actions.ts`
- `src/app/stp/records/stage-histories/actions.ts`
- `src/app/companies/actions.ts`

主な変更点:
```typescript
// 修正前
companyId: data.companyId as number,
displayOrder: data.displayOrder as number,
isActive: data.isActive as boolean,

// 修正後
companyId: Number(data.companyId),
displayOrder: data.displayOrder ? Number(data.displayOrder) : 0,
isActive: data.isActive === true || data.isActive === "true",
```

空文字列のnull変換:
```typescript
// 修正前
contactPerson: data.contactPerson as string | null,

// 修正後
contactPerson: (data.contactPerson as string) || null,
```

## 確認方法
ブラウザでページをリロードし、編集ボタン（鉛筆アイコン）をクリックして編集ダイアログが正常に動作するか確認
